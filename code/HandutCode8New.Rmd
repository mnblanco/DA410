---
title: "Handout8Code"
author: "Charlene.Cheng"
date: "2/20/2019"
output:
  pdf_document: default
  html_document: default
---

## R Markdown

#Build-in R function
```{r}
# Exploratory Factor Analysis Example
# read the dataset into R variable using the read.csv(file) function
data <-read.csv("subject.csv")
#display the data 
data
#install the package (if necessary)
install.packages("psych")
#load the package (if necessary)
library(psych)
#Using Principal Components Analysis method with correclation matrix
fit <- principal(data, nfactors = 2, rotate = 'none', covar = FALSE)
fit
```
#No Build-in R function
```{r}
corMax <- cor(data)
eigenValue <- eigen(corMax)
C <- eigenValue$vectors[,1:2]
D1 <- diag(eigenValue$values[1:2], nrow =2, ncol =2)
loadings <- C %*% sqrt(D1)
S.h2 <- rowSums(loadings^2)
S.u2 <- diag(corMax)-S.h2
prop.var <- cbind(eigenValue$values[1] / sum(eigenValue$values), eigenValue$values[2] / sum(eigenValue$values))
```


