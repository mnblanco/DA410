options ls=80;

/* EXAMPLE 7.2.2 */

FILENAME PROBE 'T3_5_PROBE.dat';
TITLE 'EXAMPLE 7.2.2';
DATA WORD;
  INFILE PROBE;
  INPUT SUBJECT POS1 POS2 POS3 POS4 POS5;
PROC IML;
  USE WORD;
  READ ALL VAR{POS1 POS2 POS3 POS4 POS5} INTO X;
  N = NROW(X);
  P = NCOL(X);
  S = 1/(N-1)*X`*(I(N)-1/N*J(N))*X;
  DETS = DET(S);
  TRS = TRACE(S);
  U1 = DET(S)*(P/TRACE(S))##P;
  UPRIME = -(N-1-(2*P##2+P+2)/(6*P))*LOG(U1);
  PRINT 'LIKELIHOOD RATIO FOR TESTING SPHERICITY OF SIGMA';
  PRINT P, DETS, TRS, U1, UPRIME;
  C = { .8904427191 -.2236067977 -.2236067977 -.2236067977 -.2236067977,
            0        .8660254038 -.2886751346 -.2886751346 -.2886751346,
            0            0        .8164965809 -.4082482905 -.4082482905,
            0            0            0        .7071067812 -.7071067812 };
  CSC = C*S*C`;
  DETCSC = DET(CSC);
  TRCSC = TRACE(CSC);
  P = NROW(C);
  U2 = DET(CSC)*((P)/TRACE(CSC))##(P);
  UPRIME = -(N-1-(2*P##2+P+2)/(6*P))*LOG(U2);
  PRINT 'LIKELIHOOD RATIO FOR TESTING SPHERICITY OF CSC`';
  PRINT P, DETCSC, TRCSC, U2, UPRIME;
ENDSAS;